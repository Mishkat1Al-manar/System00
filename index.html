<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø­ØµØ± Ø§Ø³ØªØ¦Ø°Ø§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
body {font-family: 'Cairo', sans-serif; background:#f0f4f8; margin:0; padding:0;}
header {display:flex; align-items:center; padding:15px 30px; background:linear-gradient(to left,#0d47a1,#1976d2); color:#fff;}
header img {height:65px; margin-left:20px;}
.container {padding:30px 20px; max-width:1200px; margin:auto;}
.form-box {background:#fff; padding:25px; border-radius:12px; display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px;}
.form-box label {font-weight:bold; margin-bottom:5px; display:block;}
.form-box input, .form-box select {width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; font-size:15px;}
.form-box button {background:linear-gradient(to right,#1565c0,#1e88e5); color:#fff; border:none; cursor:pointer; font-weight:bold; padding:12px 20px; border-radius:8px; font-size:15px;}
.form-box button:hover {background:#0d47a1;}
.actions {display:flex; justify-content:center; gap:15px; margin-bottom:25px;}
.actions button {padding:12px 25px; border:none; border-radius:8px; font-weight:bold; cursor:pointer; background:#1976d2; color:white; font-size:16px; transition:background 0.3s;}
.actions button:hover {background:#0d47a1;}
table {width:100%; border-collapse:collapse; background:#fff; border-radius:12px; overflow:hidden; margin-top:20px;}
th,td {padding:14px 10px; text-align:center; border-bottom:1px solid #eee; font-size:15px;}
th {background:#1565c0; color:#fff;}
footer {text-align:center; padding:18px; margin-top:30px; background:#e0e0e0; font-weight:bold;}
@media print {header,.form-box,.actions,footer {display:none;} table {box-shadow:none;}}
</style>
</head>
<body>

<header>
<img src="school.logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">
<h1>Ø­ØµØ± Ø§Ø³ØªØ¦Ø°Ø§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
</header>

<div class="container">

<div class="form-box">
<div>
<label for="name">ğŸ§‘â€ğŸ“ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
<select id="name" required>
<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨</option>
<option value="Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯">Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯</option>
<option value="Ø³Ø¹ÙˆØ¯ Ø®Ø§Ù„Ø¯">Ø³Ø¹ÙˆØ¯ Ø®Ø§Ù„Ø¯</option>
<option value="Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ ÙÙ‡Ø¯">Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ ÙÙ‡Ø¯</option>
<option value="Ø±Ø§ÙƒØ§Ù† Ù†Ø§ØµØ±">Ø±Ø§ÙƒØ§Ù† Ù†Ø§ØµØ±</option>
</select>
</div>
<div>
<label for="class">ğŸ« Ø§Ù„ØµÙ:</label>
<select id="class" required>
<option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
<optgroup label="Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ">
<option>Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ 1</option>
<option>Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ 2</option>
<option>Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ 3</option>
<option>Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ 4</option>
</optgroup>
<optgroup label="Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ">
<option>Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ 1</option>
<option>Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ 2</option>
<option>Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ 3</option>
<option>Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ 4</option>
</optgroup>
<optgroup label="Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ">
<option>Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ 1</option>
<option>Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ 2</option>
<option>Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ 3</option>
<option>Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ 4</option>
</optgroup>
</select>
</div>
<div>
<label for="day">ğŸ—“ï¸ Ø§Ù„ÙŠÙˆÙ…:</label>
<select id="day" required>
<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</option>
<option>Ø§Ù„Ø£Ø­Ø¯</option>
<option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option>
<option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
<option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
<option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
</select>
</div>
<div>
<label for="date">ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
<input type="text" id="date" placeholder="Ù…Ø«Ø§Ù„: 29-09-2025">
</div>
<div>
<label for="time">â° Ø§Ù„ÙˆÙ‚Øª:</label>
<input type="text" id="time" placeholder="Ù…Ø«Ø§Ù„: 10:30 Øµ">
</div>
<div>
<label for="reason">ğŸ“ Ø§Ù„Ø³Ø¨Ø¨:</label>
<input type="text" id="reason">
</div>
<div>
<button id="saveBtn">Ø­ÙØ¸ Ø§Ù„Ø§Ø³ØªØ¦Ø°Ø§Ù†</button>
</div>
</div>

<div class="actions">
<button onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
</div>

<table id="recordsTable">
<thead>
<tr>
<th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
<th>Ø§Ù„ØµÙ</th>
<th>Ø§Ù„ÙŠÙˆÙ…</th>
<th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
<th>Ø§Ù„ÙˆÙ‚Øª</th>
<th>Ø§Ù„Ø³Ø¨Ø¨</th>
</tr>
</thead>
<tbody></tbody>
</table>

</div>

<footer>
Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù€ Ù‚Ø³Ù… Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
</footer>

<script>
const GOOGLE_SCRIPT_URL = "Ø¶Ø¹ Ø±Ø§Ø¨Ø· Web App Ù‡Ù†Ø§";

document.getElementById("saveBtn").addEventListener("click", function(e){
e.preventDefault(); // Ù…Ù‡Ù… Ø¹Ø´Ø§Ù† Ø§Ù„Ø²Ø± Ù…Ø§ ÙŠØ¹ÙŠØ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©

const name = document.getElementById("name").value.trim();
const studentClass = document.getElementById("class").value.trim();
const day = document.getElementById("day").value.trim();
const date = document.getElementById("date").value.trim();
const time = document.getElementById("time").value.trim();
const reason = document.getElementById("reason").value.trim();

if(!name || !studentClass || !day || !date || !time){
  alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
  return;
}

const record = {name, class: studentClass, day, date, time, reason};

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø´ÙŠØª
fetch(GOOGLE_SCRIPT_URL,{
  method:"POST",
  body: JSON.stringify(record)
})
.then(res=>res.text())
.then(msg=>{
  alert(msg);
  addRow(record);
  clearFields();
})
.catch(err=>alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: "+err));

});

function addRow(record){
const tableBody=document.querySelector("#recordsTable tbody");
const row=document.createElement("tr");
row.innerHTML=`
<td>${record.name}</td>
<td>${record.class}</td>
<td>${record.day}</td>
<td>${record.date}</td>
<td>${record.time}</td>
<td>${record.reason}</td>`;
tableBody.appendChild(row);
}

function clearFields(){
document.getElementById("name").value="";
document.getElementById("class").value="";
document.getElementById("day").value="";
document.getElementById("date").value="";
document.getElementById("time").value="";
document.getElementById("reason").value="";
}
</script>

</body>
</html>

